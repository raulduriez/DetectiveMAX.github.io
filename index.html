<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Las Mil Piezas Perdidas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- ğŸ¨ Estilos -->
  <link rel="stylesheet" href="styles.css" />

  <!-- ğŸ“² Manifest PWA -->
  <link rel="manifest" href="manifest.json" />

  <!-- ğŸ”’ Firebase Analytics -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
    import { getAnalytics, logEvent } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-analytics.js";

    const firebaseConfig = {
  apiKey: "AIzaSyBbODoyyAkSw4AuIPZp9TMlZ-eVLbWkSeE",
  authDomain: "inspectormag-a88bd.firebaseapp.com",
  projectId: "inspectormag-a88bd",
  storageBucket: "inspectormag-a88bd.firebasestorage.app",
  messagingSenderId: "103921614758",
  appId: "1:103921614758:web:557b62263304f1cfc29967",
  measurementId: "G-YG0N4CMEET"
};

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    logEvent(analytics, "ingreso_index");
  </script>

  <!-- ğŸ› ï¸ Service Worker para PWA -->
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js")
        .then(() => console.log("âœ… Service Worker activo"))
        .catch(err => console.error("âŒ Error con Service Worker:", err));
    }
  </script>
</head>
<body>

  <div class="estructura-juego">
    <!-- ğŸ•µï¸ Registro del detective -->
    <div class="zona-superior">
      <h2>ğŸ” Registro del detective</h2>

      <label for="alias">Alias o nombre:</label>
      <input type="text" id="alias" placeholder="Ej. Duriez" />

      <button onclick="guardarRegistro()">Guardar datos</button>

      <h3>ğŸ–ï¸ Tu rango actual:</h3>
      <div id="rangoJugador">ğŸ§© Cargando rango...</div>

      <h3>ğŸ“ˆ Rangos disponibles:</h3>
      <ul class="lista-rangos">
        <li>ğŸ“¦ Novato: 1â€“3 casos</li>
        <li>ğŸ” Inspector: 4â€“6 casos</li>
        <li>ğŸ•µï¸ Detective: 7â€“9 casos</li>
        <li>ğŸ–ï¸ Subcomandante: 10â€“12 casos</li>
        <li>ğŸ§  Comandante: 13â€“15 casos</li>
        <li>ğŸ‘‘ Comandante General: 16+ casos</li>
      </ul>

      <button onclick="iniciarJuego()" class="boton-jugar">ğŸ® JUGAR</button>
      <button onclick="reiniciarJuego()">ğŸ§  Reiniciar progresiÃ³n</button>

    </div>

    <!-- ğŸ“œ Panel narrativo -->
    <div class="zona-inferior">
      <h2>ğŸ§  Centro de Inteligencia</h2>
      <div id="mensajeMaquina" class="texto-maquina">
        ğŸ§© Esperando validaciÃ³n de identidad...
      </div>
    </div>
  </div>

  <!-- ğŸ§  Registro e inicio -->
  <script>
    function guardarRegistro() {
      const alias = document.getElementById("alias").value.trim();
      if (alias !== "") {
        localStorage.setItem("aliasDetective", alias);
        localStorage.setItem("pistaActual", 1);
        document.getElementById("mensajeMaquina").textContent =
          `âœ… Bienvenido, ${alias}.`;
        const casos = parseInt(localStorage.getItem("casosResueltos")) || 0;
        document.getElementById("rangoJugador").textContent = obtenerRango(casos);
      } else {
        alert("ğŸ”’ Ingresa tu alias antes de continuar.");
      }
    }

    function iniciarJuego() {
      window.location.href = "mapa.html";
    }

    function obtenerRango(total) {
      if (total >= 16) return "ğŸ‘‘ Comandante General";
      if (total >= 13) return "ğŸ§  Comandante";
      if (total >= 10) return "ğŸ–ï¸ Subcomandante";
      if (total >= 7)  return "ğŸ•µï¸ Detective";
      if (total >= 4)  return "ğŸ” Inspector";
      return "ğŸ“¦ Novato";
    }

    

    window.onload = () => {
      const casos = parseInt(localStorage.getItem("casosResueltos")) || 0;
      document.getElementById("rangoJugador").textContent = obtenerRango(casos);
    };
  </script>

  <script src="core.js"></script> <!-- debe incluir escribirMaquina -->
<script src="narrativa.js"></script>
<script src="viaje.js"></script>
<script src="intervencion.js"></script>
<script src="panel.js"></script>

</body>
</html>


